/*
 * lzbase62 - LZ77(LZSS) based compression algorithm in base62 for JavaScript.
 * @version 1.4.3
 * @copyright Copyright (c) 2014-2015 polygon planet <polygon.planet.aqua@gmail.com>
 * @license Licensed under the MIT license.
 */
!function(a,b,c){"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=c():exports[a]=c():"function"==typeof define&&define.amd?define(c):b[a]=c()}("lzbase62",this,function(){"use strict";function a(a){this._init(a)}function b(a){this._init(a)}function c(){var a,b,c,d,e="abcdefghijklmnopqrstuvwxyz",f="",g=e.length;for(a=0;g>a;a++)for(c=e.charAt(a),b=g-1;b>15&&f.length<q;b--)d=e.charAt(b),f+=" "+c+" "+d;for(;f.length<q;)f=" "+f;return f=f.slice(0,q)}function d(a,b){return a.length===b?a:a.subarray?a.subarray(0,b):(a.length=b,a)}function e(a,b){if(i&&j&&s>b)try{return g.apply(null,d(a,b))}catch(c){}for(var e="",f=0;b>f;f++)e+=g(a[f]);return e}function f(a,b){if(!h)return new Array(b);switch(a){case 8:return new Uint8Array(b);case 16:return new Uint16Array(b)}}var g=String.fromCharCode,h="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,i=!1,j=!1;try{"a"===g.apply(null,[97])&&(i=!0)}catch(k){}if(h)try{"a"===g.apply(null,new Uint8Array([97]))&&(j=!0)}catch(k){}var l=!1;-1!=="abcほげ".lastIndexOf("ほげ",1)&&(l=!0);var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=m.length,o=Math.max(n,62)-Math.min(n,62),p=n-1,q=1024,r=304,s=65533,t=s,u=t-n,v=s,w=v+2*q,x=11,y=x*(x+1),z=40,A=z*(z+1),B=n+1,C=o+20,D=n+5,E=n-o-19,F=z+7,G=F+1,H=G+1,I=H+5,J=I+5;a.prototype={_init:function(a){a=a||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=a.onData,this._onEndCallback=a.onEnd},_createTable:function(){for(var a=f(8,n),b=0;n>b;b++)a[b]=m.charCodeAt(b);return a},_onData:function(a,b){var c=e(a,b);this._onDataCallback?this._onDataCallback(c):this._result+=c},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var a=2,b=this._data,c=this._offset,d=p;if(this._dataLen-c<d&&(d=this._dataLen-c),a>d)return!1;var e,f,g,h,i,j,k=c-r,m=b.substring(k,c+d),n=c+a-3-k;do{if(2===a){if(f=b.charAt(c)+b.charAt(c+1),g=m.indexOf(f),!~g||g>n)break}else 3===a?f+=b.charAt(c+2):f=b.substr(c,a);if(l?(j=b.substring(k,c+a-1),h=j.lastIndexOf(f)):h=m.lastIndexOf(f,n),!~h)break;i=h,e=k+h;do if(b.charCodeAt(c+a)!==b.charCodeAt(e+a))break;while(++a<d);if(g===h){a++;break}}while(++a<d);return 2===a?!1:(this._index=r-i,this._length=a-1,!0)},compress:function(a){if(null==a||0===a.length)return"";var b="",d=this._createTable(),e=c(),g=f(8,t),h=0;this._result="",this._offset=e.length,this._data=e+a,this._dataLen=this._data.length,e=a=null;for(var i,j,k,l,m,o=-1,q=-1;this._offset<this._dataLen;)this._search()?(this._index<p?(j=this._index,k=0):(j=this._index%p,k=(this._index-j)/p),2===this._length?(g[h++]=d[k+I],g[h++]=d[j]):(g[h++]=d[k+H],g[h++]=d[j],g[h++]=d[this._length]),this._offset+=this._length,~q&&(q=-1)):(i=this._data.charCodeAt(this._offset++),y>i?(z>i?(j=i,k=0,o=B):(j=i%z,k=(i-j)/z,o=k+B),q===o?g[h++]=d[j]:(g[h++]=d[o-C],g[h++]=d[j],q=o)):(A>i?(j=i,k=0,o=D):(j=i%A,k=(i-j)/A,o=k+D),z>j?(l=j,m=0):(l=j%z,m=(j-l)/z),q===o?(g[h++]=d[l],g[h++]=d[m]):(g[h++]=d[G],g[h++]=d[o-n],g[h++]=d[l],g[h++]=d[m],q=o))),h>=u&&(this._onData(g,h),h=0);return h>0&&this._onData(g,h),this._onEnd(),b=this._result,this._result=null,null===b?"":b}},b.prototype={_init:function(a){a=a||{},this._result=null,this._onDataCallback=a.onData,this._onEndCallback=a.onEnd},_createTable:function(){for(var a={},b=0;n>b;b++)a[m.charAt(b)]=b;return a},_onData:function(a){var b;if(this._onDataCallback){if(a)b=this._result,this._result=null;else{var c=v-q;b=this._result.substr(q,c),this._result=this._result.slice(0,q)+this._result.substring(q+c)}b.length>0&&this._onDataCallback(b)}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(a){if(null==a||0===a.length)return"";this._result=c();for(var b,d,e,f,h,i,j,k,l="",m=this._createTable(),n=!1,o=null,s=a.length,t=0;s>t;t++){if(b=m[a.charAt(t)],void 0===b)throw new Error("Out of range in decompression");if(E>b)n?(e=m[a.charAt(++t)],f=e*z+b+A*o):f=o*z+b,this._result+=g(f);else if(F>b)o=b-E,n=!1;else if(b===G)d=m[a.charAt(++t)],o=d-5,n=!0;else if(J>b){if(d=m[a.charAt(++t)],I>b?(h=(b-H)*p+d,i=m[a.charAt(++t)]):(h=(b-I)*p+d,i=2),k=this._result.slice(-r).slice(-h).substring(0,i)){for(j="";j.length<i;)j+=k;this._result+=j.substring(0,i)}o=null}this._result.length>=w&&this._onData()}return this._result=this._result.substring(q),this._onData(!0),this._onEnd(),l=this._result,this._result=null,null===l?"":l}};var K={compress:function(b,c){return new a(c).compress(b)},decompress:function(a,c){return new b(c).decompress(a)}};return K});